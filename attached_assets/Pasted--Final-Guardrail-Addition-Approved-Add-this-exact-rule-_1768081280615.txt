âœ… Final Guardrail Addition (Approved)

Add this exact rule to the decoder system prompt:

State-law fallback rule
If the user asks about a specific state or local law and no vetted state note is available for that topic/state, respond with:
â€œState-specific rules may apply â€” check your local requirements.â€

Do not attempt to explain, summarize, or infer state law beyond this statement.

This does three critical things:

Prevents hallucinated laws

Keeps responses consistent across users

Signals awareness without overstepping

ğŸ”’ Where this rule applies (important)

This fallback should trigger only when ALL are true:

The user explicitly references a state or city
(e.g., â€œIn Illinoisâ€¦â€, â€œUnder California lawâ€¦â€, â€œChicago eviction rulesâ€¦â€)

The topic is state-sensitive

No approved snippet exists in state_notes

If the user does not reference a state explicitly â†’ no need to mention state law at all.

ğŸ§  Updated Final Prompt Guardrails (Full Section)

You can hand this block directly to Replit:

State-Specific Law Guardrails:

- Do not generate or infer state or local laws.
- State-specific guidance must only come from vetted notes provided by the system.
- If the user asks about a specific state or local law and no vetted note exists for that topic/state, respond only with:
  â€œState-specific rules may apply â€” check your local requirements.â€
- Do not expand on this statement or provide additional legal interpretation.


This pairs perfectly with your DB-backed snippet approach.

ğŸ¯ UX Consistency Tip (Optional but recommended)

When this fallback fires:

Do not show the â€œState-Specific Notesâ€ accordion

Do not mention missing data

Simply include the one-line sentence inline (or as a muted footnote)

This avoids making the system feel incomplete or broken.

ğŸ§ª Example Scenarios (for confidence)
User asks:

â€œCan I deny for a misdemeanor in Illinois?â€

If IL snippet exists:
â†’ Show vetted IL state notes accordion

If IL snippet does NOT exist:
â†’ Response includes:

State-specific rules may apply â€” check your local requirements.

â€¦and nothing more about Illinois law.

User asks:

â€œWhat does a misdemeanor mean on a background check?â€

â†’ No state mention
â†’ No state fallback
â†’ Normal decoder response only

Final verdict

This clarification completes the safety model.

You now have:

deterministic state law handling

zero hallucination risk

clean UX

clear auditability

This is exactly how a legal-adjacent AI feature should behave.